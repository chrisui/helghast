!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=11)}([function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){t.exports=n.p+"02b6ead32281108e999fe09ff5ab1826.jpg"},function(t,e,n){t.exports=n.p+"19a745a1d77f59206ee9147d6308dce6.jpg"},function(t,e,n){t.exports=n.p+"18266d4952996f8d2ffdbdb901c7361d.jpg"},function(t,e,n){t.exports=n.p+"622a6e5c93b71fba71ae44c12105e5e8.jpg"},function(t,e,n){t.exports=n.p+"6fbc7c7597ca0e94ae1f7e6541b31198.jpg"},function(t,e,n){t.exports=n.p+"5d688fbd5490699b8ab791664d54c368.jpg"},function(t,e,n){"use strict";n.r(e);n(0);n(1);n(2);n(3);class o{cancelAnimationFrame(){}requestAnimationFrame(){return 0}now(){return 0}}n(4);class r{}r.input=new class{isPointerLocked(){return!1}lockPointer(){}unlockPointer(){}isContextMenuEnabled(){return!1}enableContextMenu(){}disableContextMenu(){}onKeyDown(t){return-1}onKeyUp(t){return-1}onMouseMove(t){return-1}onMouseWheel(t){return-1}onMouseDown(t){return-1}onMouseUp(t){return-1}removeEventBinding(t){return!0}getGamepads(){return[]}},r.benchmark=new class{start(t){}end(t){}push(t,e){}flush(){return[]}},r.log=new class{info(t){}warn(t){}error(t){}trace(){}},r.platform=new o,r.graphics=new class{createProgram(t,e){return null}getContext(){return null}bindContext(t){return null}};class s{constructor(t,e){this.cache=[],this.cachePointer=0,this.resources=t,this.entityCollection=e}process(){this.cachePointer=0}get(t){return this.resources[t.name]}join(...t){if(this.cache[this.cachePointer]){const t=this.cache[this.cachePointer];return this.cachePointer++,t}const e=[];for(const n in this.entityCollection)if(this.entityCollection.hasOwnProperty(n)){if(!t.every(t=>!!this.entityCollection[n].find(e=>e.constructor.name===t.name)))continue;e.push(t.map(t=>this.entityCollection[n].find(e=>e.constructor.name===t.name)))}return this.cache[this.cachePointer]=e,this.cachePointer++,e}}class i{constructor(){this.resources={},this.systems=[],this.entityId=0,this.entities=[],this.entityComponents={},this.accessors={}}}!function(t){function e(t,e,n){t.entityComponents[e]=n}t.addResource=function(t,e){t.resources[e.name]=new e},t.addSystem=function(t,e){t.systems.push(new e)},t.setup=function(t){for(const e of t.systems){const n=new s(t.resources,t.entityComponents);t.accessors[e.constructor.name]=n,e.constructor.setup&&e.constructor.setup(e,n)}},t.process=function(t){for(const e of t.systems){const n=t.accessors[e.constructor.name];n.process(),e.constructor.process&&e.constructor.process(e,n)}},t.createEntity=function(t,n){const o=t.entityId++;return t.entities.push(o),e(t,o,n),o},t.addComponents=e}(i||(i={}));const a="update";class c{constructor(){this.animationFrameId=0,this.world=new i}}!function(t){function e(t){r.benchmark.start(a),i.process(t.world),r.benchmark.end(a)}t.tick=function t(n){n.animationFrameId=r.platform.requestAnimationFrame(()=>t(n)),e(n)},t.stop=function(t){r.platform.cancelAnimationFrame(t.animationFrameId)},t.update=e}(c||(c={}));class u{constructor(){this.frame=0,this.timeScale=1,this.time=0,this.maxDeltaTime=.1,this.deltaTime=0}}class l{}var h,y,w,d;l.resources=[u],function(t){(l||(l={})).process=function(t,e){const n=e.get(u),o=r.platform.now()/1e3;n.frame+=1;let s=o-(n.time||o);s=Math.min(Math.max(s,0),n.maxDeltaTime),s*=n.timeScale,n.time=o,n.deltaTime=s}}(),function(t){t[t.Face1=0]="Face1",t[t.Face2=1]="Face2",t[t.Face3=2]="Face3",t[t.Face4=3]="Face4",t[t.LShoulder1=4]="LShoulder1",t[t.RShoulder1=5]="RShoulder1",t[t.LShoulder2=6]="LShoulder2",t[t.RShoulder2=7]="RShoulder2",t[t.Select=8]="Select",t[t.Start=9]="Start",t[t.LStick=10]="LStick",t[t.RStick=11]="RStick",t[t.Up=12]="Up",t[t.Down=13]="Down",t[t.Left=14]="Left",t[t.Right=15]="Right",t[t.Vendor=16]="Vendor"}(h||(h={})),function(t){t[t.LStickX=0]="LStickX",t[t.LStickY=1]="LStickY",t[t.RStickX=2]="RStickX",t[t.RStickY=3]="RStickY"}(y||(y={}));class x{constructor(){this.current={0:null,1:null,2:null,3:null},this.last={0:null,1:null,2:null,3:null},this.numDevices=0,this.deadzone=.25}}!function(t){t.isPressed=function(t,e,n){return!!t.current[e]&&t.current[e].buttons[n].pressed},t.wasPressed=function(t,e,n){if(!t.current[e])return!1;const o=t.current[e].buttons[n].pressed,r=t.last[e]&&t.last[e].buttons[n].pressed;return o&&!r},t.getButtonValue=function(t,e,n){return t.current[e]?t.current[e].buttons[n].value:0},t.getAxisValue=function(t,e,n){if(!t.current[e])return 0;const o=t.current[e].axes[n];return Math.abs(o)<t.deadzone?0:o}}(x||(x={}));class m{}m.resources=[x],function(t){(m||(m={})).process=function(t,e){const n=e.get(x);let o;for(o=0;o<n.numDevices;o++){if(null==n.current[o]){n.last[o]=null;continue}const t=n.current[o],e=t.buttons.length,r=n.last[o]||{buttons:new Array(e),axes:[]};let s;for(s=0;s<e;s++)r.buttons[s]=r.buttons[s]||{},r.buttons[s].value=t.buttons[s].value,r.buttons[s].pressed=t.buttons[s].pressed;n.last[o]=r}const s=r.input.getGamepads(),i=s.length;for(o=0;o<i;o++)n.current[o]=s[o];n.numDevices=i}}(),function(t){t.Backspace="Backspace",t.Tab="Tab",t.Enter="Enter",t.Shift="Shift",t.Control="Control",t.Alt="Alt",t.CapsLock="CapsLock",t.Escape="Escape",t.Space=" ",t.PageUp="PageUp",t.PageDown="PageDown",t.End="End",t.Home="Home",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Left="Left",t.Up="Up",t.Right="Right",t.Down="Down",t.Insert="Insert",t.Delete="Delete",t.Zero="0",t.ClosedParen=")",t.One="1",t.ExclamationMark="!",t.Two="2",t.AtSign="@",t.Three="3",t.PoundSign="#",t.Hash="#",t.Four="4",t.DollarSign="$",t.Five="5",t.PercentSign="%",t.Six="6",t.Caret="^",t.Hat="^",t.Seven="7",t.Ampersand="&",t.Eight="8",t.Star="*",t.Asterik="*",t.Nine="9",t.OpenParen="(",t.a="a",t.b="b",t.c="c",t.d="d",t.e="e",t.f="f",t.g="g",t.h="h",t.i="i",t.j="j",t.k="k",t.l="l",t.m="m",t.n="n",t.o="o",t.p="p",t.q="q",t.r="r",t.s="s",t.t="t",t.u="u",t.v="v",t.w="w",t.x="x",t.y="y",t.z="z",t.A="A",t.B="B",t.C="C",t.D="D",t.E="E",t.F="F",t.G="G",t.H="H",t.I="I",t.J="J",t.K="K",t.L="L",t.M="M",t.N="N",t.O="O",t.P="P",t.Q="Q",t.R="R",t.S="S",t.T="T",t.U="U",t.V="V",t.W="W",t.X="X",t.Y="Y",t.Z="Z",t.Meta="Meta",t.LeftWindowKey="Meta",t.RightWindowKey="Meta",t.Numpad0="0",t.Numpad1="1",t.Numpad2="2",t.Numpad3="3",t.Numpad4="4",t.Numpad5="5",t.Numpad6="6",t.Numpad7="7",t.Numpad8="8",t.Numpad9="9",t.Multiply="*",t.Add="+",t.Subtract="-",t.DecimalPoint=".",t.Divide="/",t.F1="F1",t.F2="F2",t.F3="F3",t.F4="F4",t.F5="F5",t.F6="F6",t.F7="F7",t.F8="F8",t.F9="F9",t.F10="F10",t.F11="F11",t.F12="F12",t.NumLock="NumLock",t.ScrollLock="ScrollLock",t.SemiColon=";",t.Equals="=",t.Comma=",",t.Dash="-",t.Period=".",t.UnderScore="_",t.PlusSign="+",t.ForwardSlash="/",t.Tilde="~",t.GraveAccent="`",t.OpenBracket="[",t.ClosedBracket="]",t.Quote="'"}(w||(w={}));class p{constructor(){this.keyStates={},this.tmpKeyStates={},this.lastKeyStates={}}}!function(t){t.isPressed=function(t,e){return t.keyStates[e]},t.wasPressed=function(t,e){const n=t.keyStates[e],o=t.lastKeyStates[e];return n&&!o}}(p||(p={}));class f{}f.resources=[p],function(t){t.setup=function(t,e){const n=e.get(p);r.input.onKeyDown(t=>(function(t,e){t.tmpKeyStates[e.key]=!0})(n,t)),r.input.onKeyUp(t=>(function(t,e){t.tmpKeyStates[e.key]=!1})(n,t))},t.process=function(t,e){const n=e.get(p);for(const t in n.tmpKeyStates)n.tmpKeyStates.hasOwnProperty(t)&&(n.lastKeyStates[t]=n.keyStates[t],n.keyStates[t]=n.tmpKeyStates[t])}}(f||(f={})),function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward"}(d||(d={}));class z{constructor(){this.x=0,this.y=0,this.deltaX=0,this.deltaY=0,this.wheelDelta=0,this.buttonStates={0:!1,1:!1,2:!1,3:!1,4:!1},this.lastButtonStates={0:!1,1:!1,2:!1,3:!1,4:!1},this.tmpButtonStates={0:!1,1:!1,2:!1,3:!1,4:!1},this.tmpXDelta=0,this.tmpYDelta=0,this.tmpX=0,this.tmpY=0,this.tmpWheelDelta=0}}!function(t){t.isPressed=function(t,e){return t.buttonStates[e]},t.wasPressed=function(t,e){const n=t.buttonStates[e],o=t.lastButtonStates[e];return n&&!o}}(z||(z={}));class g{}g.resources=[z],function(t){t.setup=function(t,e){const n=e.get(z);r.input.onMouseUp(t=>(function(t,e){t.tmpButtonStates[e.button]=!1})(n,t)),r.input.onMouseDown(t=>(function(t,e){t.tmpButtonStates[e.button]=!0})(n,t)),r.input.onMouseMove(t=>(function(t,e){t.tmpX=e.x,t.tmpY=e.y,t.tmpXDelta+=e.xDelta,t.tmpYDelta+=e.yDelta})(n,t)),r.input.onMouseWheel(t=>(function(t,e){t.tmpWheelDelta+=e.wheelDelta})(n,t))},t.process=function(t,e){const n=e.get(z);for(const t in n.tmpButtonStates)n.lastButtonStates.hasOwnProperty(t)&&(n.lastButtonStates[t]=n.buttonStates[t],n.buttonStates[t]=n.tmpButtonStates[t]);n.deltaX=n.tmpXDelta,n.deltaY=n.tmpYDelta,n.x=n.tmpX,n.y=n.tmpY,n.wheelDelta=n.tmpWheelDelta,n.tmpWheelDelta=0,n.tmpXDelta=0,n.tmpYDelta=0}}(g||(g={}));class v{constructor(){this.x=0,this.y=0,this.z=0}static create(t,e,n){const o=new v;return o.x=t,o.y=e,o.z=n,o}copy(t=new v){return t.x=this.x,t.y=this.y,t.z=this.z,t}add(t,e=new v){const n=this;return e.x=n.x+t.x,e.y=n.y+t.y,e.z=n.z+t.z,e}subtract(t,e=new v){const n=this;return e.x=n.x-t.x,e.y=n.y-t.y,e.z=n.z-t.z,e}scale(t,e=new v){const n=this;return e.x=n.x*t,e.y=n.y*t,e.z=n.z*t,e}normalize(t=new v){const e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return e>1e-5&&(t.x=this.x/e,t.y=this.y/e,t.z=this.z/e),t}cross(t,e=new v){const n=this.x,o=this.y,r=this.z;return e.x=o*t.z-r*t.y,e.y=r*t.x-n*t.z,e.z=n*t.y-o*t.x,e}toTypedArray(t=new Float32Array(3)){return t[0]=this.x,t[1]=this.y,t[2]=this.z,t}}v.Left=v.create(-1,0,0),v.Right=v.create(1,0,0),v.Up=v.create(0,1,0),v.Down=v.create(0,-1,0),v.Forward=v.create(0,0,1),v.Backward=v.create(0,0,-1);class b{constructor(){this.velocity=new v}}class S{constructor(){this.x=0,this.y=0,this.z=0,this.w=0}}class A{constructor(){this.position=new v,this.orientation=new S,this.rotation=new v,this.scale=v.create(1,1,1)}}class E{}class P{}P.resources=[p,u],P.components=[b,A,E],function(t){(P||(P={})).process=function(t,e){const n=e.get(p),o=e.get(u),r=e.join(b,A,E);for(const[t,e]of r)t.velocity.x=0,t.velocity.y=0,t.velocity.z=0,p.isPressed(n,w.ArrowRight)&&t.velocity.add(v.Right,t.velocity),p.isPressed(n,w.ArrowDown)&&t.velocity.add(v.Backward,t.velocity),p.isPressed(n,w.ArrowLeft)&&t.velocity.add(v.Left,t.velocity),p.isPressed(n,w.ArrowUp)&&t.velocity.add(v.Forward,t.velocity),p.isPressed(n,w.Home)&&t.velocity.add(v.Up,t.velocity),p.isPressed(n,w.End)&&t.velocity.add(v.Down,t.velocity),p.isPressed(n,w.Delete)&&(e.rotation.y=(e.rotation.y-1+360)%360),p.isPressed(n,w.PageDown)&&(e.rotation.y=(e.rotation.y+1)%360);const s=e.join(A);for(const[t]of s)t.position.y+=1*Math.sin(o.time),t.rotation.y=(t.rotation.y+1*o.deltaTime*10)%360}}();class _{constructor(){this.x=0,this.y=0}static create(t,e){const n=new _;return n.x=t,n.y=e,n}add(t,e=new _){return e.x=this.x+t.x,e.y=this.y+t.y,e}subtract(t,e=new _){return e.x=this.x-t.x,e.y=this.y-t.y,e}scale(t,e=new _){return e.x=this.x*t,e.y=this.y*t,e}}_.Up=_.create(0,1),_.Right=_.create(1,0),_.Down=_.create(0,-1),_.Left=_.create(-1,0);class L{constructor(){this.x=0,this.y=0,this.z=0,this.w=0}static create(t,e,n,o){const r=new L;return r.x=t,r.y=e,r.z=n,r.w=o,r}toTypedArray(t=new Float32Array(4)){return t[0]=this.x,t[1]=this.y,t[2]=this.z,t[3]=this.w,t}}class T{constructor(){this.xx=0,this.xy=0,this.xz=0,this.xw=0,this.yx=0,this.yy=0,this.yz=0,this.yw=0,this.zx=0,this.zy=0,this.zz=0,this.zw=0,this.wx=0,this.wy=0,this.wz=0,this.ww=0}static identity(t=new T){return t.xx=1,t.xy=0,t.xz=0,t.xw=0,t.yx=0,t.yy=1,t.yz=0,t.yw=0,t.zx=0,t.zy=0,t.zz=1,t.zw=0,t.wx=0,t.wy=0,t.wz=0,t.ww=1,t}static translation(t,e=new T){return e.xx=1,e.xy=0,e.xz=0,e.xw=0,e.yx=0,e.yy=1,e.yz=0,e.yw=0,e.zx=0,e.zy=0,e.zz=1,e.zw=0,e.wx=t.x,e.wy=t.y,e.wz=t.z,e.ww=1,e}static perspective(t,e,n,o,r=new T){const s=Math.tan(.5*Math.PI-.5*t),i=1/(n-o);return r.xx=s/e,r.xy=0,r.xz=0,r.xw=0,r.yx=0,r.yy=s,r.yz=0,r.yw=0,r.zx=0,r.zy=0,r.zz=(n+o)*i,r.zw=-1,r.wx=0,r.wy=0,r.wz=n*o*i*2,r.ww=0,r}static lookAt(t,e,n,o=new T){const r=t.copy().subtract(e).normalize(),s=n.copy().cross(r).normalize(),i=r.copy().cross(s).normalize();return o.xx=s.x,o.xy=s.y,o.xz=s.z,o.xw=0,o.yx=i.x,o.yy=i.y,o.yz=i.z,o.yw=0,o.zx=r.x,o.zy=r.y,o.zz=r.z,o.zw=0,o.wx=t.x,o.wy=t.y,o.wz=t.z,o.ww=1,o}static yRotation(t,e=new T){const n=Math.cos(t),o=Math.sin(t);return e.xx=n,e.xy=0,e.xz=-o,e.xw=0,e.yx=0,e.yy=1,e.yz=0,e.yw=0,e.zx=o,e.zy=0,e.zz=n,e.zw=0,e.wx=0,e.wy=0,e.wz=0,e.ww=1,e}static xRotation(t,e=new T){const n=Math.cos(t),o=Math.sin(t);return e.xx=1,e.xy=0,e.xz=0,e.xw=0,e.yx=0,e.yy=n,e.yz=o,e.yw=0,e.zx=0,e.zy=-o,e.zz=n,e.zw=0,e.wx=0,e.wy=0,e.wz=0,e.ww=1,e}inverse(t=new T){const e=this.xx,n=this.xy,o=this.xz,r=this.xw,s=this.yx,i=this.yy,a=this.yz,c=this.yw,u=this.zx,l=this.zy,h=this.zz,y=this.zw,w=this.wx,d=this.wy,x=this.wz,m=this.ww,p=h*m,f=x*y,z=a*m,g=x*c,v=a*y,b=h*c,S=o*m,A=x*r,E=o*y,P=h*r,_=o*c,L=a*r,R=u*d,F=w*l,D=s*d,M=w*i,k=s*l,C=u*i,U=e*d,I=w*n,B=e*l,V=u*n,j=e*i,Y=s*n,X=p*i+g*l+v*d-(f*i+z*l+b*d),N=f*n+S*l+P*d-(p*n+A*l+E*d),H=z*n+A*i+_*d-(g*n+S*i+L*d),K=b*n+E*i+L*l-(v*n+P*i+_*l),O=1/(e*X+s*N+u*H+w*K);return t.xx=O*X,t.xy=O*N,t.xz=O*H,t.xw=O*K,t.yx=O*(f*s+z*u+b*w-(p*s+g*u+v*w)),t.yy=O*(p*e+A*u+E*w-(f*e+S*u+P*w)),t.yz=O*(g*e+S*s+L*w-(z*e+A*s+_*w)),t.yw=O*(v*e+P*s+_*u-(b*e+E*s+L*u)),t.zx=O*(R*c+M*y+k*m-(F*c+D*y+C*m)),t.zy=O*(F*r+U*y+V*m-(R*r+I*y+B*m)),t.zz=O*(D*r+I*c+j*m-(M*r+U*c+Y*m)),t.zw=O*(C*r+B*c+Y*y-(k*r+V*c+j*y)),t.wx=O*(D*h+C*x+F*a-(k*x+R*a+M*h)),t.wy=O*(B*x+R*o+I*h-(U*h+V*x+F*o)),t.wz=O*(U*a+Y*x+M*o-(j*x+D*o+I*a)),t.ww=O*(j*h+k*o+V*a-(B*a+Y*h+C*o)),t}copy(t=new T){return t.xx=this.xx,t.xy=this.xy,t.xz=this.xz,t.xw=this.xw,t.yx=this.yx,t.yy=this.yy,t.yz=this.yz,t.yw=this.yw,t.zx=this.zx,t.zy=this.zy,t.zz=this.zz,t.zw=this.zw,t.wx=this.wx,t.wy=this.wy,t.wz=this.wz,t.ww=this.ww,t}multiply(t,e=new T){const n=t.xx,o=t.xy,r=t.xz,s=t.xw,i=t.yx,a=t.yy,c=t.yz,u=t.yw,l=t.zx,h=t.zy,y=t.zz,w=t.zw,d=t.wx,x=t.wy,m=t.wz,p=t.ww,f=this.xx,z=this.xy,g=this.xz,v=this.xw,b=this.yx,S=this.yy,A=this.yz,E=this.yw,P=this.zx,_=this.zy,L=this.zz,R=this.zw,F=this.wx,D=this.wy,M=this.wz,k=this.ww;return e.xx=n*f+o*b+r*P+s*F,e.xy=n*z+o*S+r*_+s*D,e.xz=n*g+o*A+r*L+s*M,e.xw=n*v+o*E+r*R+s*k,e.yx=i*f+a*b+c*P+u*F,e.yy=i*z+a*S+c*_+u*D,e.yz=i*g+a*A+c*L+u*M,e.yw=i*v+a*E+c*R+u*k,e.zx=l*f+h*b+y*P+w*F,e.zy=l*z+h*S+y*_+w*D,e.zz=l*g+h*A+y*L+w*M,e.zw=l*v+h*E+y*R+w*k,e.wx=d*f+x*b+m*P+p*F,e.wy=d*z+x*S+m*_+p*D,e.wz=d*g+x*A+m*L+p*M,e.ww=d*v+x*E+m*R+p*k,e}transpose(t=new T){const e=this.xx,n=this.xy,o=this.xz,r=this.xw,s=this.yx,i=this.yy,a=this.yz,c=this.yw,u=this.zx,l=this.zy,h=this.zz,y=this.zw,w=this.wx,d=this.wy,x=this.wz,m=this.ww;return t.xx=e,t.xy=s,t.xz=u,t.xw=w,t.yx=n,t.yy=i,t.yz=l,t.yw=d,t.zx=o,t.zy=a,t.zz=h,t.zw=x,t.wx=r,t.wy=c,t.wz=y,t.ww=m,t}toTypedArray(t=new Float32Array(16)){return t[0]=this.xx,t[1]=this.xy,t[2]=this.xz,t[3]=this.xw,t[4]=this.yx,t[5]=this.yy,t[6]=this.yz,t[7]=this.yw,t[8]=this.zx,t[9]=this.zy,t[10]=this.zz,t[11]=this.zw,t[12]=this.wx,t[13]=this.wy,t[14]=this.wz,t[15]=this.ww,t}translate(t,e=new T){const n=this.xx,o=this.xy,r=this.xz,s=this.xw,i=this.yx,a=this.yy,c=this.yz,u=this.yw,l=this.zx,h=this.zy,y=this.zz,w=this.zw,d=this.wx,x=this.wy,m=this.wz,p=this.ww;return this!==e&&(e.xx=n,e.xy=o,e.xz=r,e.xw=s,e.yx=i,e.yy=a,e.yz=c,e.yw=u,e.zx=l,e.zy=h,e.zz=y,e.zw=w),e.wx=n*t.x+i*t.y+l*t.z+d,e.wy=o*t.x+a*t.y+h*t.z+x,e.wz=r*t.x+c*t.y+y*t.z+m,e.ww=s*t.x+u*t.y+w*t.z+p,e}transformVector(t,e=new L){return e.x=0,e.x+=t.x*this.xx,e.x+=t.y*this.yx,e.x+=t.z*this.zx,e.x+=t.w*this.wx,e.y=0,e.y+=t.x*this.xy,e.y+=t.y*this.yy,e.y+=t.z*this.zy,e.y+=t.w*this.wy,e.z=0,e.z+=t.x*this.xz,e.z+=t.y*this.yz,e.z+=t.z*this.zz,e.z+=t.w*this.wz,e.w=0,e.w+=t.x*this.xw,e.w+=t.y*this.yw,e.w+=t.z*this.zw,e.w+=t.w*this.ww,e}}function R(t){return t*Math.PI/180}var F="#version 300 es\n#define GLSLIFY 1\n\n// an attribute is an input (in) to a vertex shader.\n// It will receive data from a buffer\nin vec4 a_position;\nin vec3 a_normal;\n\nuniform mat4 u_worldViewProjection;\nuniform mat4 u_worldInverseTranspose;\n\n// varying to pass the normal to the fragment shader\nout vec3 v_normal;\n\n// all shaders have a main function\nvoid main() {\n  // Multiply the position by the matrix.\n  gl_Position = u_worldViewProjection * a_position;\n\n  // orient the normals and pass to the fragment shader\n  v_normal = mat3(u_worldInverseTranspose) * a_normal;\n}",D="#version 300 es\n\nprecision mediump float;\n#define GLSLIFY 1\n\n// Passed in and varied from the vertex shader.\nin vec3 v_normal;\n\nuniform vec3 u_reverseLightDirection;\nuniform vec4 u_color;\n\n// we need to declare an output for the fragment shader\nout vec4 outColor;\n\nvoid main() {\n  // because v_normal is a varying it's interpolated\n  // so it will not be a uint vector. Normalizing it\n  // will make it a unit vector again\n  vec3 normal = normalize(v_normal);\n\n  // compute the light by taking the dot product\n  // of the normal to the light's reverse direction\n  float light = dot(normal, u_reverseLightDirection);\n\n  outColor = u_color;\n\n  // Lets multiply just the color portion (not the alpha)\n  // by the light\n  outColor.rgb *= light;\n}",M="#version 300 es\n#define GLSLIFY 1\nin vec4 a_position;\nout vec4 v_position;\nvoid main() {\n  v_position = a_position;\n  gl_Position = a_position;\n  gl_Position.z = 1.0;\n}",k="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n \nuniform samplerCube u_skybox;\nuniform mat4 u_viewDirectionProjectionInverse;\n \nin vec4 v_position;\n \n// we need to declare an output for the fragment shader\nout vec4 outColor;\n \nvoid main() {\n  vec4 t = u_viewDirectionProjectionInverse * v_position;\n  outColor = texture(u_skybox, normalize(t.xyz / t.w));\n}";const C="render";class U{}U.resources=[u],U.components=[A,class{constructor(){this.dimensions=new _,this.fillColor=new v}}],function(t){t.setup=function(t){const e=r.graphics.getContext();!function(t,e){const o=r.graphics.createProgram(M,k);t.skyboxProgram=o;const s=e.getAttribLocation(o,"a_position");t.uSkyboxLocation=e.getUniformLocation(o,"u_skybox"),t.uSkyboxViewDirectionProjectionInverseLocation=e.getUniformLocation(o,"u_viewDirectionProjectionInverse");const i=e.createVertexArray();t.skyboxVao=i,e.bindVertexArray(i);const a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a);const c=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);e.bufferData(e.ARRAY_BUFFER,c,e.STATIC_DRAW),e.enableVertexAttribArray(s),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0);const u=e.createTexture();e.bindTexture(e.TEXTURE_CUBE_MAP,u),[{target:e.TEXTURE_CUBE_MAP_POSITIVE_X,url:n(5)},{target:e.TEXTURE_CUBE_MAP_NEGATIVE_X,url:n(6)},{target:e.TEXTURE_CUBE_MAP_POSITIVE_Y,url:n(7)},{target:e.TEXTURE_CUBE_MAP_NEGATIVE_Y,url:n(8)},{target:e.TEXTURE_CUBE_MAP_POSITIVE_Z,url:n(9)},{target:e.TEXTURE_CUBE_MAP_NEGATIVE_Z,url:n(10)}].forEach(t=>{const{target:n,url:o}=t,r=e.RGBA,s=e.RGBA,i=e.UNSIGNED_BYTE;e.texImage2D(n,0,r,1024,1024,0,s,i,null);const a=new Image;a.src=o,a.addEventListener("load",function(){e.bindTexture(e.TEXTURE_CUBE_MAP,u),e.texImage2D(n,0,r,s,i,a),e.generateMipmap(e.TEXTURE_CUBE_MAP)})}),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)}(t,e),function(t,e){const n=r.graphics.createProgram(F,D);t.objProgram=n;const o=e.getAttribLocation(n,"a_position"),s=e.getAttribLocation(n,"a_normal");t.uWorldViewProjectionLocation=e.getUniformLocation(n,"u_worldViewProjection"),t.uWorldInverseTransposeLocation=e.getUniformLocation(n,"u_worldInverseTranspose"),t.uColorLocation=e.getUniformLocation(n,"u_color"),t.uReverseLightDirectionLocation=e.getUniformLocation(n,"u_reverseLightDirection");const i=e.createBuffer(),a=e.createVertexArray();t.objVao=a,e.bindVertexArray(a),e.enableVertexAttribArray(o),e.bindBuffer(e.ARRAY_BUFFER,i);const c=function(){const t=new Float32Array([0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0]);let e=T.xRotation(Math.PI);e=e.translate(v.create(-50,-75,-15));for(let n=0;n<t.length;n+=3){const o=e.transformVector(L.create(t[n+0],t[n+1],t[n+2],1));t[n+0]=o.x,t[n+1]=o.y,t[n+2]=o.z}return t}();e.bufferData(e.ARRAY_BUFFER,c,e.STATIC_DRAW),e.vertexAttribPointer(o,3,e.FLOAT,!1,0,0);const u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u);const l=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]);e.bufferData(e.ARRAY_BUFFER,l,e.STATIC_DRAW),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,3,e.FLOAT,!1,0,0)}(t,e)},t.process=function(t,e){r.benchmark.start(C),e.get(u);const n=e.join(A),o=r.graphics.getContext(),s=t.objProgram,i=t.objVao;!function(t){const e=0|t.clientWidth,n=0|t.clientHeight;if(t.width!==e||t.height!==n)t.width=e,t.height=n}(o.canvas),o.viewport(0,0,o.canvas.width,o.canvas.height);const a=o.canvas.clientWidth/o.canvas.clientHeight,c=R(60),l=T.perspective(c,a,1,2e3),h=v.create(100,150,200),y=n[0][0].position,w=v.create(0,1,0),d=T.lookAt(h,y,w).inverse(),x=d.copy();x.wx=0,x.wy=0,x.wz=0;const m=l.multiply(d),p=l.multiply(x).inverse();o.disable(o.DEPTH_TEST),o.disable(o.CULL_FACE),o.useProgram(t.skyboxProgram),o.bindVertexArray(t.skyboxVao),o.uniformMatrix4fv(t.uSkyboxViewDirectionProjectionInverseLocation,!1,p.toTypedArray()),o.uniform1i(t.uSkyboxLocation,0),o.drawArrays(o.TRIANGLES,0,6),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.useProgram(s),o.bindVertexArray(i);for(const[e]of n){let n=T.yRotation(R(e.rotation.y));n=T.translation(e.position).multiply(n);const r=m.multiply(n),s=n.inverse().transpose();o.uniformMatrix4fv(t.uWorldViewProjectionLocation,!1,r.toTypedArray()),o.uniformMatrix4fv(t.uWorldInverseTransposeLocation,!1,s.toTypedArray()),o.uniform4fv(t.uColorLocation,[.2,1,.2,1]),o.uniform3fv(t.uReverseLightDirectionLocation,v.create(.5,.7,1).normalize().toTypedArray()),o.drawArrays(o.TRIANGLES,0,96)}r.benchmark.end(C)}}(U||(U={}));class I{constructor(){this.tmpVelocity=new v}}I.resources=[u],I.components=[A,b],function(t){(I||(I={})).process=function(t,e){const n=e.get(u),o=e.join(A,b);for(const[e,r]of o)e.position.add(r.velocity.scale(100*n.deltaTime,t.tmpVelocity),e.position)}}();r.input=new class{constructor(){this.flagIsContextMenuEnabled=!0,this.listeners={},this.lastListenerId=-1}isPointerLocked(){return!document.pointerLockElement}lockPointer(){document.body.requestPointerLock()}unlockPointer(){document.exitPointerLock()}isContextMenuEnabled(){return this.flagIsContextMenuEnabled}disableContextMenu(){this.flagIsContextMenuEnabled=!1,window.addEventListener("contextmenu",this.preventDefaultHandler)}enableContextMenu(){this.flagIsContextMenuEnabled=!0,window.removeEventListener("contextmenu",this.preventDefaultHandler)}onKeyDown(t){return this.createEventBinding("keydown",this.mapKeyEventHandler(t))}onKeyUp(t){return this.createEventBinding("keyup",this.mapKeyEventHandler(t))}onMouseDown(t){return this.createEventBinding("mousedown",this.mapMouseEventHandler(t))}onMouseUp(t){return this.createEventBinding("mouseup",this.mapMouseEventHandler(t))}onMouseWheel(t){return this.createEventBinding("mousescroll",this.mapMouseEventHandler(t))}onMouseMove(t){return this.createEventBinding("mousemove",this.mapMouseEventHandler(t))}removeEventBinding(t){return window.removeEventListener(this.listeners[t].type,this.listeners[t].listener),delete this.listeners[t],!0}getGamepads(){return navigator.getGamepads()}createEventBinding(t,e){const n=++this.lastListenerId;return this.listeners[n]={type:t,listener:e},window.addEventListener(t,e),n}preventDefaultHandler(t){t.preventDefault()}mapMouseEventHandler(t){return e=>{t({button:e.button,wheelDelta:e instanceof WheelEvent?e.deltaY/Math.abs(e.deltaY):0,x:e.clientX,y:e.clientY,xDelta:e.movementX,yDelta:e.movementY})}}mapKeyEventHandler(t){return e=>{t({key:e.key,code:e.code})}}},r.log=new class{info(t){console.log(t)}warn(t){console.warn(t)}error(t){console.error(t)}trace(){console.trace()}},r.platform=new class{cancelAnimationFrame(t){return cancelAnimationFrame(t)}requestAnimationFrame(t){return requestAnimationFrame(t)}now(){return performance.now()}},r.graphics=new class{bindContext(t){this.gl=t}getContext(){return this.gl}createProgram(t,e){const n=this.gl.createProgram(),o=this.createShader(this.gl.VERTEX_SHADER,t),r=this.createShader(this.gl.FRAGMENT_SHADER,e);if(this.gl.attachShader(n,o),this.gl.attachShader(n,r),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS))return n;const s=this.gl.getProgramInfoLog(n);throw this.gl.deleteProgram(n),new Error(s||void 0)}createShader(t,e){const n=this.gl.createShader(t);if(this.gl.shaderSource(n,e),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS))return n;const o=this.gl.getShaderInfoLog(n);throw this.gl.deleteShader(n),new Error(o||void 0)}};const B=document.querySelector("#app").getContext("webgl2");r.graphics.bindContext(B);const V=new c;i.addResource(V.world,u),i.addResource(V.world,class{constructor(){this.frameTimings=[],this.flushedNum=0}}),i.addResource(V.world,p),i.addResource(V.world,z),i.addResource(V.world,x),i.addSystem(V.world,l),i.addSystem(V.world,g),i.addSystem(V.world,f),i.addSystem(V.world,m),i.addSystem(V.world,P),i.addSystem(V.world,I),i.addSystem(V.world,U);for(let t=0;t<10;t++){const e=new A;e.position.x=100*t,e.position.y=0,e.position.z=-300-100*t;const n=0===t?[e,new b,new E]:[e,new b];i.createEntity(V.world,n)}i.setup(V.world),c.tick(V)}]);
//# sourceMappingURL=bundle.js.map